# การทดลองที่ 3 เรื่อง การเขียนโปรแกรมเอ้าต์พุทสัญญาณดิจิทัล

## วัตถุประสงค์
*  เพื่อเขียนโปรแกรมลงไมโครคอนโทรเลอร์และการนำเอ้าต์พุทไปใช้งานกับอุปกรณ์อื่น

## อุปกรณ์ที่ใช้
1.	ไมโครคอนโทรเลอร์ เช่น  ESP_01
2.	USB
3.	อุปกรณ์ต่อ USB to Serial Port
4.	อุปกรณ์ที่ใช้ในเขียนโปรแกรม เช่น คอมพิวเตอร์ เป็นต้น
5.	Adapter
6.	หลอด LED 
7.	Relay

## ศึกษาข้อมูลเบื้องต้น
1. การติดตั้งโปรแกรม
   * https://www.youtube.com/watch?v=ocrGdJoP90Y
2. ข้อมูลของไมโครคอนโทรเลอร์
   * [PlatformIO]( https://platformio.org/ )
   * [ESP_01](https://docs.platformio.org/en/latest/boards/espressif8266/esp01_1m.html)

* ตัวอย่างการทำการทดลอง
  * [03 run example 3](https://youtu.be/CCnN1WJsXQY)
  * [03 run relay]( https://youtu.be/6JnhaUILGuw)

## วิธีการทำการทดลอง 
* ตอนที่ 1
  1.เริ่มจากการต่อ USB ที่ต่อเชื่อมกับคอมพิวเตอร์ เข้ากับตัว USB to Serial Port

  ![image](https://user-images.githubusercontent.com/80879777/112014167-386fc300-8b5d-11eb-9ae9-118774ac8e2d.png)

  2.นำ Adapterต่อเข้าทาง Serial Port
  
  ![image](https://user-images.githubusercontent.com/80879777/112043443-43d1e700-8b7b-11eb-983a-67b0a39824c3.png)

  3.นำ ไมโครคอนโทรเลอร์ (ESP_01) ต่อเข้ากับ Serial Port ของ Adapter
  
  ![image](https://user-images.githubusercontent.com/80879777/112043502-50eed600-8b7b-11eb-883c-053317478ee0.png)
  
  4.ต่อหลอด LED ที่พอร์ต 0 และ 2
  
  ![image](https://user-images.githubusercontent.com/80879777/112045429-6d8c0d80-8b7d-11eb-9155-62dc70fcf070.png)

  5.ทำการเปิดโปรแกรม( Command Prompt )ที่จะทำการรัน เข้าโฟลเดอร์ที่บันทึกตัวอย่างโปรแกรมเอาไว้ โดยการทดลองนี้ จะเรียกใช้ตัวอย่างโปรแกรมที่ 03 พิมพ์ **03_Output-Port**  และพิมพ์  **vi src/main.cpp** 

  ![image](https://user-images.githubusercontent.com/80879777/112043570-6401a600-8b7b-11eb-913a-958bfed148ed.png)

  6.รันคำสั่ง **pio run -t upload** เพื่อที่จะ upload โปรแกรม  03_Output-Port ลงใน ESP_01
  
  ![image](https://user-images.githubusercontent.com/80879777/112043628-74b21c00-8b7b-11eb-9ba7-3e4d8d19322f.png)

  7.กดปุ่มดำค้างไว้แล้วกดปุ่ม reset เพื่อให้ ESP_01 รับโปรแกรมใหม่เข้าไป 
 
  ![image](https://user-images.githubusercontent.com/80879777/112043717-8b587300-8b7b-11eb-9eb9-0be349803367.png)

  8.รันคำสั่ง* pio device monitor* เพื่อดูผลที่แสดงผลออกมาบนmonitor 
   
  ![image](https://user-images.githubusercontent.com/80879777/112044148-0d489c00-8b7c-11eb-9972-af6d2d9169d4.png)

  9.ลองกดปุ่มสีแดง(reset)
 
* ตอนที่ 2
  1.ถอดไมโครคอนโทรเลอร์ (ESP_01) ออกจาก Serial Port ของ Adapter แล้วนำไปต่อกับ Serial Port ของ Relay พร้อมต่อไฟ 5 V เข้า Relay
![image](https://user-images.githubusercontent.com/80879777/112044717-b8f1ec00-8b7c-11eb-809b-b22ddb80d42b.png)

* บันทึกผลการทดลอง


## การบันทึกผลการทดลอง
* ตอนที่ 1
  * จากการทดลองจะเห็นผลที่แสดงออกมาบน monitor จะแสดงผล on – off สลับกัน และหลอด LED 	จะสว่างและดับสลับกันทุกๆ 0.5 S
  
  ![image](https://user-images.githubusercontent.com/80879777/112047173-81d10a00-8b7f-11eb-82a2-983060660399.png)

  * เมื่อกดปุ่มสีแดง(reset) ตัวไมโครคอนโทรเลอร์จะ reset แล้วจะเริ่มต้นใหม่ และจะแสดงผลเหมือนเดิม
  
  ![image](https://user-images.githubusercontent.com/80879777/112047135-767dde80-8b7f-11eb-827e-b543543465c6.png)


* ตอนที่ 2
  * relay จะทำการเปิด-ปิด สวิสต์สลับกันทุกๆ 0.5 S

  ![image](https://user-images.githubusercontent.com/80879777/112047085-62d27800-8b7f-11eb-8575-62402c9dc1b9.png)

## อภิปรายผลการทดลอง
จากการทดลองที่ 3 เรื่อง การเขียนโปรแกรมเอ้าต์พุทสัญญาณดิจิทัล
* ตอนที่ 1
  *  เราสามารถที่จะเขียนโปรแกรมที่ใช้ในการรันบนไมโครคอนโทรเลอร์ โดยการทดลองตอนที่ 1 เมื่อรันคำสั่งของตัวอย่างที่ 03_Output-Port ลงไปบนตัวไมโครคอนโทรเลอร์ ( ESP_01 ) หลังจากรันคำสั่งหมดแล้ว ตัวโปรแกรมจะแสดงผลออกมาบน monitor on – off สลับกัน ไปเรื่อย ๆ และหลอด LED ที่พอร์ตที่ 0 จะสว่างและดับสลับกันทุกๆ 0.5 S โดยเมื่อที่ monitor แสดงผล on หลอด LED จะสว่าง ส่วนเมื่อที่ monitor แสดงผล off หลอด LED จะดับ ดังนั้น จะเห็นเป็นไฟกะพริบที่จะสว่างทุกๆ 0.5 S ส่วน หลอด LED ที่พอร์ตที่ 2 เนื่องจากไม่มีการ set ทำให้ไม่เกิดผลกับหลอด LED หลอดนี้ และเมื่อกดปุ่มสีแดง(reset) ตัวไมโครคอนโทรเลอร์จะ reset  แล้วจะเริ่มต้นใหม่ โดยจะแสดงผลออกมาเหมือนเดิม
* ตอนที่ 2
  *  เมื่อนำไมโครคอนโทรเลอร์ (ESP_01) ที่ได้หลังจากการทดลองตอนที่1 (ลงโปรแกรมแล้ว) นำไปต่อกับ Serial Port ของ Relay พร้อมจ่ายไฟเลี้ยงให้กับตัว relay ตัวไมโครคอนโทรเลอร์จะควบคุมการทำานของ relay ให้เป็นเหมือนสวิซ์เปิด-ปิด ทุกๆ 0.5S ตามการ on - off ของตัวไมโครคอนโทรเลอร์

## คำถามหลังการทดลอง 
   * ถ้าหากต้องการทำให้ไฟกระพริบจากทุกๆ 0.5 S เป็น ทุกๆ 1 S ทำได้หรือไม่ แล้วถ้าทำได้ ต้องทำอย่างไร
      * ทำได้ โดยการไปแก้ในส่วนของ code จากตรง delay(500) เปลี่ยนเป็น delay(1000)
